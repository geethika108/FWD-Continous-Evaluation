<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DevRush - Task 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- No external fonts, using system fonts -->

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Inter", "Segoe UI", sans-serif;
    }

    body {
        background: radial-gradient(circle at top left, #0f1b2e, #060b18 60%);
        color: white;
        min-height: 100vh;
        overflow-x: hidden;
    }

    /* NAVBAR */
    nav {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px 40px;
        flex-wrap: wrap;
    }

    nav h1 {
        font-size: 18px;
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .join-btn {
        margin-left: 15px;
        padding: 8px 24px;
        border-radius: 20px;
        background: linear-gradient(90deg, #6a7cff, #2dd4ff);
        color: white;
        text-decoration: none;
        font-size: 14px;
        font-weight: 600;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        white-space: nowrap;
        cursor: pointer;
        border: none; /* Reset button styles */
    }

    .join-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(45, 212, 255, 0.4);
    }
    
    .join-btn:active {
        transform: scale(0.95);
    }

    /* HERO */
    .hero {
        min-height: 70vh;
        padding: 40px 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        position: relative;
    }

    .hero-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(18px);
        -webkit-backdrop-filter: blur(18px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        padding: 60px 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        max-width: 600px;
        width: 100%;
        animation: fadeIn 1s ease-out;
    }

    .hero-card h2 {
        font-size: clamp(28px, 5vw, 42px);
        margin-bottom: 16px;
        background: linear-gradient(to right, #fff, #a5b4fc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .hero-card p {
        opacity: 0.85;
        font-size: 16px;
        line-height: 1.6;
        color: #cbd5e1;
        margin-bottom: 30px; 
    }

    /* Primary Hero Button Styles */
    .primary-btn {
        display: inline-block;
        padding: 14px 36px;
        border-radius: 30px;
        background: white;
        color: #0f1b2e;
        text-decoration: none;
        font-weight: 700;
        font-size: 16px;
        transition: all 0.2s ease;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        cursor: pointer;
    }

    .primary-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(255, 255, 255, 0.25);
        background: #f8fafc;
    }

    .primary-btn:active {
        transform: scale(0.95);
    }

    /* STATS */
    .stats {
        display: flex;
        justify-content: center;
        gap: 60px;
        margin-top: -40px;
        position: relative;
        z-index: 2;
        padding: 0 20px;
        flex-wrap: wrap;
    }

    .stat {
        text-align: center;
        background: rgba(6, 11, 24, 0.8);
        padding: 15px 25px;
        border-radius: 12px;
        border: 1px solid rgba(255,255,255,0.05);
        min-width: 120px;
    }

    .stat h3 {
        font-size: 32px;
        font-weight: 700;
        color: #2dd4ff;
    }

    .stat span {
        font-size: 14px;
        opacity: 0.7;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* FEATURES */
    .features {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 100px 0;
        padding: 0 20px;
        flex-wrap: wrap;
    }

    .card {
        width: 260px;
        padding: 30px;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        transition: 0.3s;
        cursor: pointer;
    }

    .card.active {
        background: linear-gradient(135deg, rgba(106, 124, 255, 0.1), rgba(45, 212, 255, 0.1));
        border: 1px solid rgba(45, 212, 255, 0.3);
    }
    
    .card.active h4 {
        color: #2dd4ff;
    }

    .card:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.07);
    }

    .card h4 {
        font-size: 18px;
        margin-bottom: 12px;
        font-weight: 600;
    }

    .card p {
        font-size: 14px;
        opacity: 0.7;
        line-height: 1.5;
    }

    /* MODULES */
    .modules {
        text-align: center;
        margin-bottom: 80px;
        padding: 0 20px;
    }

    .modules h2 {
        font-size: 28px;
        margin-bottom: 40px;
        font-weight: 600;
    }

    .module-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        max-width: 800px;
        margin: 0 auto;
        gap: 20px;
        justify-content: center;
    }

    .module {
        padding: 25px;
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: 0.3s;
        font-size: 15px;
        font-weight: 500;
        cursor: pointer;
    }

    .module.highlight {
        background: linear-gradient(135deg, #6a7cff, #2dd4ff);
        color: white;
        border: none;
        box-shadow: 0 10px 20px rgba(45, 212, 255, 0.3);
    }

    .module:hover:not(.highlight) {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.08);
    }
    
    .module.highlight:hover {
        transform: translateY(-5px) scale(1.02);
    }

    /* --- LOADING SCREEN STYLES --- */
    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at top left, #0f1b2e, #060b18 60%);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s ease, visibility 0.5s;
    }

    .loading-screen.visible {
        opacity: 1;
        visibility: visible;
    }

    .loading-card {
        background: rgba(26, 32, 44, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 16px;
        padding: 40px 50px;
        text-align: center;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        width: 90%;
        max-width: 420px;
        position: relative;
    }

    .spinner {
        width: 45px;
        height: 45px;
        border: 3px solid rgba(255, 255, 255, 0.1);
        border-top: 3px solid #2dd4ff;
        border-radius: 50%;
        margin: 0 auto 24px auto;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading-card h2 {
        font-size: 22px;
        margin-bottom: 8px;
        color: white;
        font-weight: 600;
    }

    .loading-card p {
        color: #94a3b8;
        font-size: 14px;
        margin-bottom: 24px;
    }

    #skipBtn {
        background: transparent;
        border: none;
        color: #2dd4ff;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: color 0.2s;
    }

    #skipBtn:hover {
        color: #6a7cff;
        text-decoration: underline;
    }

    /* --- NEW REGISTRATION MODAL STYLES --- */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(8px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9998; /* Below loading screen */
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .register-card {
        background: rgba(15, 27, 46, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        padding: 40px;
        width: 90%;
        max-width: 450px;
        position: relative;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        transform: translateY(20px);
        transition: transform 0.3s ease;
    }

    .modal-overlay.active .register-card {
        transform: translateY(0);
    }

    .close-modal {
        position: absolute;
        top: 20px;
        right: 20px;
        background: transparent;
        border: none;
        color: rgba(255, 255, 255, 0.5);
        font-size: 24px;
        cursor: pointer;
        transition: color 0.2s;
    }

    .close-modal:hover {
        color: white;
    }

    .register-header h2 {
        font-size: 24px;
        margin-bottom: 10px;
        color: white;
    }
    
    .register-header p {
        font-size: 14px;
        color: #94a3b8;
        margin-bottom: 30px;
    }

    .form-group {
        margin-bottom: 20px;
        text-align: left;
    }

    .form-group label {
        display: block;
        font-size: 13px;
        color: #cbd5e1;
        margin-bottom: 8px;
        font-weight: 600;
    }

    .form-input {
        width: 100%;
        padding: 12px 16px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        color: white;
        font-size: 14px;
        transition: border-color 0.2s, box-shadow 0.2s;
    }

    .form-input:focus {
        outline: none;
        border-color: #2dd4ff;
        box-shadow: 0 0 0 3px rgba(45, 212, 255, 0.1);
    }

    .submit-btn {
        width: 100%;
        margin-top: 10px;
        padding: 14px;
        border-radius: 8px;
        background: linear-gradient(90deg, #6a7cff, #2dd4ff);
        color: white;
        border: none;
        font-weight: 600;
        font-size: 16px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(45, 212, 255, 0.3);
    }

    /* FOOTER */
    footer {
        text-align: center;
        padding: 40px 20px;
        color: rgba(255, 255, 255, 0.4);
        font-size: 14px;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        margin-top: auto;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Mobile adjustments */
    @media (max-width: 600px) {
        .stats { gap: 20px; margin-top: 20px; }
        .hero { min-height: auto; padding-top: 60px; padding-bottom: 60px; }
        nav { flex-direction: column; gap: 20px; width: 100%; }
        nav h1 { margin-bottom: 5px; }
        .join-btn { margin-left: 0; width: 100%; max-width: 300px; text-align: center; padding: 12px; }
        .primary-btn { width: 100%; display: block; }
        .hero-card { padding: 40px 25px; }
        .loading-card { padding: 30px; }
        .register-card { padding: 30px 25px; }
    }
</style>
</head>

<body>

<div class="loading-screen" id="loadingScreen">
    <div class="loading-card">
        <div class="spinner"></div>
        <h2>Preparing Your Challenge</h2>
        <p>You will be redirected in <span id="countdown">5</span> seconds</p>
        <button id="skipBtn">Skip & Continue</button>
    </div>
</div>

<div class="modal-overlay" id="registerModal">
    <div class="register-card">
        <button class="close-modal" id="closeModal">&times;</button>
        <div class="register-header">
            <h2>Create Profile</h2>
            <p>Setup your dev identity to track scores.</p>
        </div>
        <form id="registerForm">
            <div class="form-group">
                <label for="username">Dev Handle</label>
                <input type="text" id="username" class="form-input" placeholder="e.g. CodeNinja" required>
            </div>
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" class="form-input" placeholder="you@devrush.com" required>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" class="form-input" placeholder="••••••••" required>
            </div>
            <button type="submit" class="submit-btn">Initialize Account</button>
        </form>
        <p style="text-align: center; margin-top: 20px; color: #94a3b8;">Already have an account? <a href="#" id="switchToLogin" style="color: #2dd4ff;">Login</a></p>
    </div>
</div>

<div class="modal-overlay" id="loginModal">
    <div class="register-card">
        <button class="close-modal" id="closeLoginModal">&times;</button>
        <div class="register-header">
            <h2>Login</h2>
            <p>Access your dev profile.</p>
        </div>
        <form id="loginForm">
            <div class="form-group">
                <label for="loginEmail">Email Address</label>
                <input type="email" id="loginEmail" class="form-input" placeholder="you@devrush.com" required>
            </div>
            <div class="form-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" class="form-input" placeholder="••••••••" required>
            </div>
            <button type="submit" class="submit-btn">Login</button>
        </form>
        <p style="text-align: center; margin-top: 20px; color: #94a3b8;">Don't have an account? <a href="#" id="switchToRegister" style="color: #2dd4ff;">Register</a></p>
    </div>
</div>

<nav>
    <h1>DevRush Build. Fix. Escape.</h1>
    <button id="joinBtn" class="join-btn">Join Now</button>
</nav>

<section class="hero">
    <div class="hero-card">
        <h2>Build Under Pressure</h2>
        <p>Speed, precision, and creativity decide the winner. Are you ready to code against the clock?</p>
        <a href="#" id="startBtn" class="primary-btn">Start Challenge</a>
    </div>
</section>

<section class="stats">
    <div class="stat">
        <h3>15+</h3>
        <span>Minutes</span>
    </div>
    <div class="stat">
        <h3>30</h3>
        <span>Points</span>
    </div>
    <div class="stat">
        <h3>1</h3>
        <span>Winner</span>
    </div>
</section>

<section class="features">
    <div class="card">
        <h4>Precision</h4>
        <p>Exact spacing and alignment are required to pass the visual tests.</p>
    </div>
    <div class="card active">
        <h4>Speed</h4>
        <p>Time works against you. Every second counts in the final score.</p>
    </div>
    <div class="card">
        <h4>Focus</h4>
        <p>No distractions allowed. Deep work state is mandatory.</p>
    </div>
</section>

<section class="modules">
    <h2>Challenge Modules</h2>
    <div class="module-grid">
        <div class="module">Layout Replication</div>
        <div class="module">CSS Styling</div>
        <div class="module highlight">Glass UI</div>
        <div class="module">Color Theory</div>
        <div class="module">Spacing Logic</div>
        <div class="module">Time Control</div>
    </div>
</section>

<footer>
    <p>&copy; 2026 RAM. All rights reserved.</p>
</footer>

<script>
    // --- REDIRECTION LOGIC ---
    const loadingScreen = document.getElementById('loadingScreen');
    const countdownSpan = document.getElementById('countdown');
    const skipBtn = document.getElementById('skipBtn');
    
    // Buttons
    const startBtn = document.getElementById('startBtn'); // The Hero button
    const joinBtn = document.getElementById('joinBtn');   // The Nav button

    // Modal Elements
    const registerModal = document.getElementById('registerModal');
    const closeModal = document.getElementById('closeModal');
    const registerForm = document.getElementById('registerForm');

    let countdownInterval;

    // Function to handle the loading screen flow
    function startRedirection() {
        // Show loading screen
        loadingScreen.classList.add('visible');
        
        // If modal was open, hide it
        registerModal.classList.remove('active');

        let timeLeft = 5;
        countdownSpan.innerText = timeLeft;

        // Clear any existing interval
        if(countdownInterval) clearInterval(countdownInterval);

        countdownInterval = setInterval(() => {
            timeLeft--;
            countdownSpan.innerText = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(countdownInterval);
                finishRedirection();
            }
        }, 1000);
    }

    function finishRedirection() {
        const title = loadingScreen.querySelector('h2');
        const desc = loadingScreen.querySelector('p');
        const spinner = loadingScreen.querySelector('.spinner');
        
        spinner.style.borderTopColor = '#4ade80'; // Turn green
        spinner.style.animation = 'none';
        
        title.innerText = "Challenge Started!";
        desc.innerText = "Good luck, developer.";
        skipBtn.style.display = 'none';
        
        // Logic to move to next page would go here
    }

    // --- BUTTON EVENT LISTENERS ---

    // 1. "Start Challenge" Button -> Goes directly to Loading
    startBtn.addEventListener('click', (e) => {
        e.preventDefault();
        startRedirection();
    });

    // 2. "Join Now" Button -> Opens Register Modal
    joinBtn.addEventListener('click', (e) => {
        e.preventDefault();
        registerModal.classList.add('active');
    });

    // 3. Close Modal Button
    closeModal.addEventListener('click', () => {
        registerModal.classList.remove('active');
    });

    // 4. Click outside modal to close
    registerModal.addEventListener('click', (e) => {
        if (e.target === registerModal) {
            registerModal.classList.remove('active');
        }
    });

    // 5. Submit Register Form -> API Call
    registerForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = registerForm.querySelector('.submit-btn');
        const originalText = btn.innerText;
        btn.innerText = "Creating Account...";

        const formData = new FormData(registerForm);
        const data = {
            username: formData.get('username'),
            email: formData.get('email'),
            password: formData.get('password')
        };

        try {
            const response = await fetch('/api/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            if (response.ok) {
                localStorage.setItem('token', result.token);
                localStorage.setItem('user', JSON.stringify(result.user));
                btn.innerText = originalText;
                registerForm.reset();
                registerModal.classList.remove('active');
                updateUIForLoggedInUser(result.user);
                alert('Registration successful!');
            } else {
                alert(result.message);
            }
        } catch (error) {
            alert('Registration failed');
        } finally {
            btn.innerText = originalText;
        }
    });

    // Skip button logic
    skipBtn.addEventListener('click', () => {
        clearInterval(countdownInterval);
        finishRedirection();
    });

    // Login form handler
    const loginForm = document.getElementById('loginForm');
    const loginModal = document.getElementById('loginModal');
    const closeLoginModal = document.getElementById('closeLoginModal');

    loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = loginForm.querySelector('.submit-btn');
        const originalText = btn.innerText;
        btn.innerText = "Logging in...";

        const formData = new FormData(loginForm);
        const data = {
            email: formData.get('loginEmail'),
            password: formData.get('loginPassword')
        };

        try {
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            if (response.ok) {
                localStorage.setItem('token', result.token);
                localStorage.setItem('user', JSON.stringify(result.user));
                btn.innerText = originalText;
                loginForm.reset();
                loginModal.classList.remove('active');
                updateUIForLoggedInUser(result.user);
                alert('Login successful!');
            } else {
                alert(result.message);
            }
        } catch (error) {
            alert('Login failed');
        } finally {
            btn.innerText = originalText;
        }
    });

    // Close login modal
    closeLoginModal.addEventListener('click', () => {
        loginModal.classList.remove('active');
    });

    // Switch between modals
    document.getElementById('switchToLogin').addEventListener('click', (e) => {
        e.preventDefault();
        registerModal.classList.remove('active');
        loginModal.classList.add('active');
    });

    document.getElementById('switchToRegister').addEventListener('click', (e) => {
        e.preventDefault();
        loginModal.classList.remove('active');
        registerModal.classList.add('active');
    });

    // Update UI for logged in user
    function updateUIForLoggedInUser(user) {
        const joinBtn = document.getElementById('joinBtn');
        joinBtn.innerText = `Welcome, ${user.username}`;
        joinBtn.disabled = true;
        joinBtn.style.opacity = '0.6';
    }
</script>

</body>
</html>